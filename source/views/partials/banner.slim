- isSpecialPage = ["landing_page", "home"].include? @entry[:TYPE]
- isChildPage = @entry[:TYPE] == "child_page"
- isHomepage = @entry[:TYPE] == "home"
- isLandingPage = @entry[:TYPE] == "landing_page"

header.banner{
  class="banner--#{
    isSpecialPage ? "full" : "semi"
  }"
  style="height: #{ isSpecialPage ? "100vh" : "66.6666vh" };"
}

  / Image
  .banner__image{
    class="#{ "banner__image--" + @entry[:banner_image][:focus] }"
  }
    picture

      / Landscape
      source{
        media="(orientation: landscape)"
        sizes="100vw"
        srcset="#{ @entry[:banner_image][:url] }?w=640&q=50&fl=progressive 640w,
                #{ @entry[:banner_image][:url] }?w=854&q=50&fl=progressive 854w,
                #{ @entry[:banner_image][:url] }?w=1280&q=50&fl=progressive 1280w,
                #{ @entry[:banner_image][:url] }?w=1920&q=50&fl=progressive 1920w"
      }

      / Portrait
      source{
        media="(orientation: portrait)"
        sizes="100vw"
        srcset="#{ @entry[:banner_image][:url] }?#{
                   entry == "landing_page" ?
                   "fit=fill&w=360&h=640&q=50&fl=progressive" :
                   "fit=fill&w=360&h=360&q=50&fl=progressive"
                }&f=#{ @entry[:banner_image][:focus] } 360w,
                #{ @entry[:banner_image][:url] }?#{
                   entry == "landing_page" ?
                   "fit=fill&w=720&h=1280&q=50&fl=progressive" :
                   "fit=fill&w=720&h=720&q=50&fl=progressive"
                }&f=#{ @entry[:banner_image][:focus] } 720w,
                #{ @entry[:banner_image][:url] }?#{
                   entry == "landing_page" ?
                   "fit=fill&w=1080&h=1440&q=50&fl=progressive" :
                   "fit=fill&w=1080&h=1080&q=50&fl=progressive"
                }&f=#{ @entry[:banner_image][:focus] } 1080w"
      }

      / Fallback
      img{
        srcset="#{ @entry[:banner_image][:url] }?f=#{ @entry[:banner_image][:focus] }"
        alt="#{ @entry[:banner_image].alt }"
      }

  / Content wrapper
  .banner__inner{
    class="#{ "banner__inner--overlap" if isChildPage }"
  }

    / Content
    .banner__content{
      class="#{ "e-mgn-auto-x__sm banner__content--text-bg" if isSpecialPage }"
    }

      - if isChildPage
        span.label-xs #{ @entry[:meta_label] }

      / Title
      h1{
        class="#{ isSpecialPage ? "title-xxl" : "title-xl" }"
      }= @entry[:title]

      - if isSpecialPage
        p.banner__strap= @entry[:subtitle]

      / Actions
      - if isLandingPage && @entry[:calls_to_action] != nil
        .section-sm
          .grid.grid--xs.grid--above-sm-center
            - @entry[:calls_to_action].each do |cta|
              .grid__cell

                / Download
                - if cta[:action] == "download"
                  = partial "views/partials/btn",
                    locals: { local_data: \
                      { type: "link", size: "lg", style: "primary",
                        label: cta.button_text, label_size: "lg", url: cta[:file][:url] }}

                / Modal
                - if cta[:action] == "modal"

                  / Modal button
                  = partial "views/partials/btn",
                    locals: { local_data: \
                      { type: "state",
                        size: "lg", style: "secondary",
                        label_on: cta[:button_text], label_off: "Close",
                        label_size: "lg",
                        page: "no-scroll", exclusive: true, switch: true,
                        aria_id: "activate-#{ cta.modal[:cta_id] }",
                        aria_target_id: cta.modal[:cta_id] }}

      - if isHomepage
        - twitter = siteData(:twitter)
        - linkedin = siteData(:linkedin)
        - facebook = siteData(:facebook)
        .grid.grid--xxs.grid--above-sm-center.e-mgn-t-sm
          = partial "views/partials/social",
            locals: { local_data: \
              { icons: [twitter, linkedin, facebook] }}


  / Modal content (here to avoid banner__inner transform cascade)
  - if isLandingPage && @entry[:calls_to_action] != nil
    - @entry[:calls_to_action].each do |cta|
      - if cta[:action] == "modal"
        = partial "views/partials/modal",
          locals: { local_data: \
          { id: cta.modal[:cta_id],
            content: cta.modal[:content] }}

  / Scroll down
  - if isSpecialPage
    a.banner__scroll.e-col-orange{
      href="#arrow-dest"
    }
      = partial "views/partials/icon",
        locals: \
        { icon: "ios-arrow-thin-down",
          size: "lg" }
