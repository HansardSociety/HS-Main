<%
featured = @entry[:featured]
introduction = @entry[:introduction] ? @entry[:introduction] : siteData(:site_title)
imageURL = @entry[:banner_image][:url]
pageURL = "#{ siteData(:site_url) }/#{ @entry[:slug] }"
title = @entry[:title]

isHome = @entry[:TYPE] == "home"
%>

<head>
  <meta content="IE=edge" http-equiv="X-UA-Compatible" />
  <meta charset="utf-8" />

  <%# No index %>
  <% if config[:ENV] != "production"%>
    <meta content="noindex" name="robots" />
  <% end %>

  <%# Stylesheets %>
  <% [config[:CSS_VENDOR], config[:CSS_APP]].each do |stylesheet| %>
    <link
      rel="stylesheet"
      href="<%= assetsDir %><%= stylesheet %>"/>
  <% end %>

  <%# Snipcart assets %>
  <% if featured && featured.any? { |featured| featured.TYPE.include? "product" } %>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
    <script
      id="snipcart"
      src="https://cdn.snipcart.com/scripts/2.0/snipcart.js"
      data-api-key="<%= config[:SNIPCART_TKN] %>"></script>
  <% end %>

  <%# Twitter %>
  <meta content="summary_large_image" name="twitter:card"/>
  <meta content="@HansardSociety" name="twitter:site"/>
  <meta content="<%= title %>" name="twitter:title"/>
  <meta content="<%= introduction %>" name="twitter:description"/>
  <meta content="https:<%= @entry[:banner_image].url %>" name="twitter:image"/>

  <%# Facebook %>
  <meta property="og:url" content=pageURL/>
  <meta property="og:type" content="article"/>
  <meta property="og:title" content="<%= title %>"/>
  <meta property="og:description" content="<%= introduction %>"/>
  <meta property="og:image" content="https:<%= imageURL %>?w=1920&h=1008&fit=crop"/>
  <meta property="og:image:width" content="1920"/>
  <meta property="og:image:height" content="1008"/>

  <%# Responsive %>
  <meta content="width=device-width, initial-scale=1" name="viewport" />

  <title><%= title + " - " + siteData(:site_title) if !isHome %></title>

  <meta
    name="description"
    content="<%= truncateHtml(introduction, { num: 154, elipsis: false }) %>"/>

  <% if config[:ENV] == "production" %>
    <%= siteData(:meta)[:analytics] %>
  <% end %>
</head>
